中国图书分类号   O313; O322                           密    级   公开    
国际图书分类号      531                               单位代码   10613   



西 南 交 通 大 学
硕 士 学 位 论 文



数据驱动的非线性振动系统辨识与控制研究



学 科 专 业 航空宇航科学与技术 
学        号     2023201157     
作 者 姓 名      蒋 纪 元      
指导老师   唐  介  副教授   
学        院 力学与航空航天学院 




2024 年 4 月 13 日

A Thesis Submitted to 
Southwest Jiaotong University for Master Degree



Research on Identification and Control of Nonlinear Vibration System based on Data-driven Approaches




Discipline    Aerospace Science   	
             and Technology    	
Student ID      2023201157    	
Author      Jiyuan Jiang      	
Supervisor   Assoc. Prof. Jie Tang	
School  School of Mechanics and
 Aerospace Engineering	




Apr. 21, 2024

西南交通大学
学位论文独创性声明

本人郑重声明：所呈交的学位论文是本人在导师指导下进行的研究工作及取得的研究成果。据我所知，除了文中特别加以标注和致谢的地方外，论文中不包含其他人已经发表或撰写过的研究成果，也不包含为获得西南交通大学或其它教育机构的学位或证书而使用过的材料。其他人员对本研究所做的任何贡献均已在论文中作了明确的说明并表示谢意。
本学位论文的主要创新点如下：
1. 基于无模型强化学习算法训练非线性振动系统的神经网络最优控制器
2. 基于先验物理软约束和RK4-PINN方法对准零刚度隔振器进行数据驱动建模，并基于其代理动力学模型搭建虚拟环境用以与无模型优化算法进行数据交互。
3. 通过子结构物理神经网络将RK4-PINN方法推广到多级非线性隔振系统的代理动力学模型辨识，并以其为预测模型，基于模型预测控制原理训练神经网络最优控制器。





作者签名：                
	                                     日期：      年    月   日


西南交通大学
学位论文使用授权

本学位论文作者完全了解西南交通大学有关保留、使用学位论文的规定，同意学校有权保留并向国家有关部门或机构送交论文的复印件和电子版，允许论文被查阅。本人授权西南交通大学可以将学位论文的全部或部分内容编入有关数据库进行检索及下载，可以采用影印、缩印、扫描等复制手段保存、汇编本学位论文。
本学位论文属于
1．保密□，在   年解密后适用本授权书；
2．不保密□，使用本授权书。
（请在以上方框内打“√”）
作者签名：		导师签名：	
日期：     年   月   日

摘  要
振动是导致仪器性能下降和结构疲劳破坏的常见原因，传统线性隔振器难以有效隔离低频振动。以准零刚度(QZS)系统为代表的非线性隔振器被广泛应用。然而，随着折纸、仿生等概念的不断引入和对隔振性能要求的提升，非线性隔振器的结构设计趋于复杂，难以直接机理建模；同时，非线性隔振系统的隔振性能对负载变化较为敏感。因此，有必要对非线性隔振系统的辨识和最优实时调控展开研究，以提升隔振器在各类工况下的隔振性能。本文以非线性振动系统为被控对象，基于数据驱动方法，系统性地研究了其动力学系统辨识和最优主动控制问题。主要的研究内容如下：
(1) Van der Pol振动系统无模型最优控制研究
Van der Pol振动系统是一种具有自激性的非线性振动系统。采用两种无模型强化学习方法，在没有先验控制经验的指引下，通过与被控对象和奖励函数的数据交互训练神经网络控制器，并与LQR控制器进行控制性能比对。结果表明，所训练的神经网络控制器能够有效抑制振动，其控制性能能够逼近基于模型和先验控制经验求解的LQR控制器。
(2) 主动QZS隔振器辨识与控制研究
　　负载变化会显著影响QZS隔振器隔振性能。基于QZS隔振器的输入激励和输出响应，通过先验物理软约束和RK4-PINN方法建立其代理动力学模型，并与奖励函数构成虚拟环境。使用PSO算法和TD3算法与该环境交互，优化PID控制器参数和训练神经网络控制器。结果表明，所辨识的代理动力学模型能够准确反应原模型的动力学特性；引入优化的主动控制后，主动QZS隔振器具备对抗负载变化能力，且隔振性能进一步提升
(3) 多级非线性隔振系统神经网络模型预测控制研究
　　提出基于RK4-PINN改进的子结构物理信息神经网络方法，基于多级非线性隔振系统的输入激励和输出响应建立其代理动力学模型，并将其作为预测模型。基于模型预测控制(MPC)原理训练神经网络控制器，规避了传统MPC算法的实时求解。结果表明，所辨识的代理动力学模型能够准确预测原模型的动力学响应；所训练的神经网络控制器能够实现代价函数意义下的最优振动控制。
关键词：非线性振动，数据驱动，准零刚度，最优控制，机器学习
ABSTRACT
Vibration is a common cause of performance degradation in instruments and structural fatigue failure. Traditional linear isolators are ineffective in attenuating low-frequency vibrations. Nonlinear vibration isolators, represented by quasi-zero stiffness (QZS) systems, have been widely adopted. However, with the introduction of origami-inspired and bioinspired designs and increasing performance demands, the structural complexity of nonlinear isolators has grown, making mechanism-based modeling challenging. Moreover, their isolation performance is sensitive to load variations. Therefore, it is necessary to investigate system identification and optimal real-time control of nonlinear isolators to enhance their performance under diverse operating conditions. This paper focuses on nonlinear vibration systems and systematically studies their dynamic modeling and optimal active control using data-driven methods. The main contributions are as follows:
(1) Model-Free optimal control of the van der Pol vibration system
　　The van der Pol system is a self-excited nonlinear vibration system. Two model-free reinforcement learning methods are employed to train neural network controllers via data interaction with the system and reward function, without prior control knowledge. And their control performance is compared with the LQR controller. Results show that the trained controllers effectively suppress vibrations and approach the performance of model-based LQR control.
(2) Identification and control of the active QZS vibration system
Load variation significantly affects the performance of the QZS vibration isolator. A surrogate dynamic model is established using input-output data, prior physics soft constraint, and the RK4-PINN method. This model, combined with a reward function, forms a virtual environment. The PSO and TD3 algorithms are used to optimize PID controller parameters and train neural network controllers, respectively. Results indicate that the identified model accurately captures the system dynamics, and the optimized controllers can enhance load adaptability and vibration isolation performance.
(3) Neural network model predictive controllers for multi-layer nonlinear vibration isolation system
　　A substructure PINN method improved with RK4-PINN is proposed to identify a surrogate dynamic model for multi-layer nonlinear vibration isolation systems based on input-output data. The surrogate dynamic model is used as the prediction model for training neural network controllers under the model predictive control (MPC) framework, avoiding real-time optimization. Results demonstrate that the identified model accurately predicts system dynamic responses, and the trained controllers achieve optimal vibration control in the sense of the defined cost functions.
Keywords: Nonlinear Vibration, Data-driven approach, Quasi-Zero-Stiffness, Optimal Control, Machine Learning

目  录
第1章	绪论	1
1.1 研究背景及意义	1
1.2 研究现状	2
1.2.1 非线性隔振系统研究现状	2
1.2.2 非线性振动系统辨识方法研究现状	5
1.2.3 最优主动振动控制研究现状	7
1.3 有待进一步研究的问题	8
1.4 本文主要研究内容	8
第2章	基于强化学习的van der Pol振动系统最优控制研究	9
2.1 LQR最优控制	9
2.1.1 线性时不变系统的LQR最优控制	9
2.1.2 非线性时不变系统的LQR近似最优控制	9
2.2 基于深度强化学习的最优振动控制原理	10
2.2.1 强化学习与最优控制	10
2.2.2 TD3算法	11
2.2.3 SAC算法	13
2.3 控制器训练与性能分析	14
2.3.1 Van der Pol振动系统与强化学习环境	14
2.3.2 训练过程	17
2.3.3 控制器性能分析	17
2.4 本章小结	22
第3章	主动准零刚度隔振器辨识与控制研究	23
3.1 主动QZS隔振器代理动力学模型辨识	23
3.1.1 主动QZS隔振器动力学模型	23
3.1.2 混合驱动的代理动力学模型	25
3.1.3 主动QZS代理动力学模型建模	26
3.1.4 代理动力学模型预测精度检验	28
3.2 主动控制律优化	29
3.2.1 奖励函数和目标函数	29
3.2.2 基于PSO算法的PID控制器	30
3.2.3 基于虚拟环境训练近似最优控制器	31
3.3 主动QZS隔振器性能分析	33
3.3.1 变负载工况	33
3.3.2 其他隔振情形	35
3.4 本章小结	36
第4章	多级非线性隔振系统神经网络模型预测控制研究	37
4.1 多级非线性隔振系统的代理动力学模型	37
4.1.1 多级非线性隔振系统的动力学建模	37
4.1.2 子结构物理信息神经网络	38
4.1.3 多级非线性隔振系统的代理动力学辨识	40
4.1.4 代理动力学模型预测精度检验	41
4.2 基于代理动力学模型的神经网络模型预测控制器	44
4.2.1 最优模型预测控制	44
4.2.2 神经网络最优控制器	44
4.2.3 神经网络控制器训练	45
4.3 多级非线性隔振器的主动隔振性能	46
4.4 本章小结	48
结论与展望	49
结论	49
展望	50
致   谢	51
参考文献	52
攻读硕士学位期间取得的研究成果	57


第1章 绪论
1.1 研究背景及意义
振动广泛存在于自然界和人类的生产生活中。振动不仅会干扰设备和仪器的正常工作，也会带来机械结构破坏、疲劳损伤、可靠性下降等挑战[1]。近年来，航空航天产业蓬勃发展，越来越多的搭载精密仪器[2]和大型柔性结构[3]的载荷通过运载火箭发射到宇宙中。而这些精密仪器和柔性结构更易受到火箭发射过程中低频振动的影响，导致设备性能下降或破坏。因此，除了利用振动的情形，有必要采取有效的振动抑制措施，保证仪器和结构的正常工作。
根据有无外部能量输入，振动控制通常分为被动抑制和主动控制[4]。被动抑制技术无需外部能量输入，具有结构简单、经济性好、易于维护等特点，在实际工程中得到广泛运用[5]。其中，被动控制又可大致分为线性隔振、非线性隔振和动力吸振。对于线性隔振器，仅在外部激励频率大于其固有频率的倍时才能有效隔振，而通过降低刚度的方式来降低固有频率又会使其承载能力下降[6]。对于动力吸振技术，调谐质量阻尼器[7]和非线性能量汇[8]是两类具有代表性的研究，其将主结构的振动能量转移到附加结构上，并通过阻尼耗散。但是，附加结构会提升系统重量，难以满足如飞行器等运载工具的减重要求。线性隔振器和动力吸振技术的固有缺陷使研究人员转向非线性隔振领域。准零刚度(Quasi-Zero Stiffness, QZS)隔振器是一种具有高承载力和低动刚度的非线性隔振器[9]，被广泛运用于低频隔振。QZS隔振器需要一个特定载荷将系统预压至零平衡位置处，对负载变化十分敏感，即使负载仅有微小的变化，也会对隔振器的性能产生较大影响[10]。虽然有关于可调刚度以实现大范围的负载的研究[11]，但是对结构进行调节较为复杂，也很难满足实时调节的需求。主动控制能够对系统进行主动调控，具有质量轻、实时性好等特点，能够显著地改善被动振动抑制技术中的缺陷[12]。将主动控制引入QZS隔振器，不仅能够补偿变化的负载以维持其QZS特性，并且能够依照一定的控制策略施加主动控制力，进一步提升隔振器的隔振性能[13]。
在研究主动振动控制问题时，针对被控系统，寻找一种控制规律，使其在振动抑制效果、控制力大小、响应快速性等指标构成的代价函数上是最优的，以实现最佳的综合控制性能。最优振动控制问题存在两点挑战：1. 对于非线性振动系统，如何求解其在自定义代价函数下的最优控制律；2. 对于复杂的非线性结构，通过机理建模较为困难，在实际工程情况下难以获取被动对象的精确动力学模型。回顾最优控制理论，对于线性时不变系统，线性二次调节器(Linear Quadratic Regulator, LQR)[14]是一种最为经典的控制算法。对于非线性最优控制，则需要求解Hamilton-Jacobi-Bellman(HJB)方程[15]。在被控对象为非线性动力学系统和目标函数较为复杂的情况下，解析求解HJB方程可能代价高昂或不可行。此外，直接求解最优控制律需要被控对象的准确数学模型，这对于复杂非线性结构或实际工程情况下往往难以实现。在这种情形下，采集被控对象的输入激励和输出响应相对更容易实现。因此，针对复杂非线性振动系统的动力建模与最优控制律求解问题，研究逆向建模和非解析的优化算法是一种可行的方案。
　　数据驱动和人工智能技术是当前的研究热点。近十年前，AlphaGo就已经能够击败人类的围棋世界冠军，并且不断的自我学习迭代，击败上一代的智能体[16]。近两年，大语言模型的迅猛进步使得智能体已经能够理解和生成自然语言文本，并具备相当的逻辑推理能力[17]。因此，将数据科学和人工智能方向的先进研究和思想与系统辨识与最优控制求解问题相结合，能够从新的视角审视振动最优控制问题的解决方法和思路，实现跨学科的交叉研究，具备相应的实际意义。
1.2研究现状
1.2.1 非线性隔振系统研究现状
QZS隔振器具有高承载力和低动刚度特性，是一种被广泛研究和应用的非线性隔振系统。Alabuzhev[18]首次提出将具有QZS特性的结构用于隔振，并系统地研究了QZS隔振器的固有频率和承载能力。Carrella[9]和Kovacic[19, 20]从非线性动力学的角度出发，系统地研究了三弹簧结构的QZS隔振器的动力学特性。研究表明，其幅频曲线表现出硬化特性，且存在跳变现象；力传递率曲线和位移传递率曲线展现了较低的起始隔振频率，这表明QZS隔振器在低频微振动隔振领域具有巨大应用潜力。由此，涌现了一大批关于QZS结构设计的研究。如欧拉屈曲梁构型[21]、X铰构型[22]、弹簧-连杆组合构型[23]、电磁-空气弹簧构型[24]，等等。

图 11 经典QZS隔振器构型：(a) 欧拉屈曲梁构型[21]；(b) X铰构型[22]；(c)弹簧-连杆组合构型[23]；(d) 电磁-空气弹簧构型[24]
随着折纸结构、仿生设计等概念的兴起，它们的思想被广泛运用到非线性隔振系统的研究中。受鹰蛾气囊结构的启发，基于设计Kresling折纸和超临界音叉分岔理论，韩河生[25]设计了一种轻质可展开的QZS隔振器。该折纸结构具备可折叠和完全展开功能，具有占用空间小、质量轻的特点，能够满足航空航天工程中的低频隔振需求。Liu等[26]提出了一种基于Tachi-Miura折纸的弹性关节隔振系统，具有较强的设计灵活性和可调性，能够通过配置不同的系统参数值来适应各种隔振场景。Ye和Ji[27]提出了一种基于桁架弹簧的堆叠Miura-ori折纸结构，并在特定参数下实现了QZS结构。其使用线性螺旋弹簧代替折痕，并沿折痕方向提供线性刚度，即改进了传统折纸结构的物理实现，又同时保持了与基于折痕的折纸结构相似的特征。

图12 折纸隔振系统：(a) 仿鹰蛾气囊结构Kresling折纸轻质可折叠QZS隔振器[25]；(b) 基于Tachi-Miura折纸的弹性关节隔振系统[26]；(c) 基于桁架弹簧的堆叠Miura-ori折纸的QZS隔振器[27]
多级非线性隔振系统能够搭载更多负载，并进一步提升隔振性能。Wang等[28]设计了一种电磁式的双层QZS隔振器，并通过谐波平衡法计算其位移传递率，发现其具有良好的低频隔振性能。Wang等[29]分析了三种具有QZS特性的非线性二自由度隔振器的动态特性，并与单自由度QZS隔振器和二自由度线性隔振器在峰值动态位移、峰值传递率、单位隔振频带和-40dB隔振频带这4项性能指标上进行比对。研究表明，当综合考虑这4项隔振性能指标时，二自由度QZS隔振器具有更好的表现。Zhou等[30]设计了一种易于堆叠的多层QZS单元结构，实现了微振动的有效低频隔振，并评估了单元层数和隔振性能的关系。结果表明，QZS单元结构在隔振方向上堆叠的层数越多，隔振性能越强。受鸟类颈部结构的启发，Deng等[31]和Sun等[32]分别设计了仿鸟类颈部的多层三弹簧串联仿生隔振器和仿鸟类颈部的多层隔振结构及其标准单元结构，实现了超低频段内的隔振。

图13 多级非线性隔振系统：(a) 多层QZS超结构[30]；(b) 仿鸟类颈部的多层三弹簧串联仿生隔振器[31]；(c) 仿鸟类颈部的多层隔振结构及其标准单元结构[32]
对非线性隔振系统，在有重力情况下，其负载的质量变化会显著影响其隔振性能，这需要隔振系统具有一定的调节能力。Chen等[33]提出了一种正刚度可调的QZS隔振器，以减少载荷质量变化对隔振性能的负面影响。Wen等[34]设计了一种基于位移反馈主动调整斜弹簧的倾斜角度，从而改变系统刚度的半主动QZS隔振器。该方法进一步扩大了QZS有效位移范围，提升了大振幅情形下QZS隔振器的隔振性能。Sun等[35]将主动控制引入QZS隔振器中，通过主动力补偿载荷质量变化而产生的重力差，实现了变负载情形下的快速调节和有效隔振。

图14 可调节非线性隔振系统：(a) 正刚度可调QZS隔振器[33]；(b) 半主动刚度调节QZS隔振器[34]；(c) 主动QZS隔振器[35]
综上所述，目前对以QZS隔振器为代表的非线性隔振系统的设计理念和隔振性能研究较为系统和成熟。研究关注点从其结构实现和非线性响应特性逐渐发展到轻量化设计、仿生启发设计和可调性设计，以实现更低的起始隔振频率和更广泛的使用情形。但关于可实时调节的非线性隔振系统的仍未得到充分研究，且应用的控制理论仍处于较为基础的阶段，有待进一步的研究和发展。
1.2.2非线性振动系统辨识方法研究现状
对于难以通过机理方法建模的具有复杂结构的非线性振动系统，或是实际工程情形下难以理论建模的情形，可以基于振动系统的输入激励和输出响应，逆向构建其动力学模型。
早期的振动系统辨识方法较为简单。如通过最小二乘法或极大似然法估计振动系统参数，拟合振动系统传递函数等[36]。20世纪90年代，对线性时不变系统，提出了子空间辨识法，如规范变量分析法[37]、多变量输出误差状态空间法[38]和基于数值算法的子空间状态空间系统辨识方法[39]。对非线性振动系统，Qu等[40]提出了从受迫振动中识别非线性结构的参数的多解析模态分解；Wei等[41]在非线性子空间辨识方法的基础上开发了非线性子空间预测误差法。但这些算法在数学处理上较为复杂，面对具有复杂非线性特性的振动模型往往需要人为舍弃一些非线性项，降低了系统辨识的精度。
群体智能优化算法和深度学习方法的提出和发展为振动系统辨识方法提供了新的思路。群体智能优化算法的理念来源自对社群动物的行为研究，如蚂蚁、鸟群等。较为经典方法有遗传算法[42]、粒子群优化(Particle Swarm Optimization, PSO)算法[43]和差分进化算法[44]等。遗传算法对待优化参数进行二进制编码，以目标优化函数作为迭代过程中的搜索信息，模仿染色体的复制、交叉、变异等行为，筛选适应度高的个体组成新的种群，使种群适应度不断提高，以达到目标所搜条件。相较于遗传算法，PSO 算法采用实数编码，基于当前已搜索到的全局最优粒子和个体粒子自身的历史最优信息，驱动种群所有粒子在解空间中不断运动来搜寻全局最优解，使算法更加简洁。而差分进化算法则采用实数编码、基于差分的简单变异和竞争生存策略，降低了遗传操作的复杂性。这类算法的优点在于支持并行计算，且能够处理不连续、非线性等复杂函数，能够对复杂系统进行参数辨识。在运用群体智能优化算法进行振动系统辨识时，可以先假设待辨识系统的数学形式，再通过优化算法更细系统参数，以最小化预测响应与实际测量响应的误差。Kristinsson和 Dumont[45]将遗传算法用于连续时间系统与离散时间系统的系统辨识；Modares 等[46]运用 PSO 算法进行混沌动力学系统的参数辨识；Tang等[47]运用差分进化算法实现了多自由度振动系统的参数辨识。这说明群体智能优化算法在非线性振动系统的系统参数辨识问题中具有巨大的应用潜力。
深度学习通过深度神经网络建立输入值与输出值的联系，通过最小化神经网络在训练数据集上的误差更细神经网络参数。神经网络是强大的函数拟合工具，通用近似定理[48, 49]证明，神经网络能够以任意精度逼近有界连续函数。常见的神经网络结构有前馈神经网络、卷积神经网络、循环神经网络等[50]。其中，循环神经网络可以以任意的准确率去近似任何一个非线性动力系统。长短期记忆(Long Short-Term Memory, LSTM)网络[52]和门控循环单元(Gated Recurrent Unit, GRU)网络[53]是循环神经网络的两种变体，常用于时间序列分析、自然语言处理等问题。但是，前馈神经网络或循环神经网络仅能在离散的时间空间中推演动力学系统的状态转换。对处理振动系统这类在时间上连续的动力系统，很容易因误差的迅速累积而失真。Chen 等[54]提出了神经网络常微分方程(Neural ordinary differential equations, NODE)。其使用神经网络估计状态关于时间的导数，并通过数值积分将系统推进到下一时刻的状态。Habiba和Pearlmutter[55]将NODE方法推广到LSTM网络和GRU网络上。基于NODE的框架，Zhang等[56]提出了一种子结构数据驱动建模方法用于多自由度非线性动力学系统的辨识。但是，仅仅采用黑箱模型训练神经网络存在物理可解释性差，在训练集以外的泛化能力弱等问题。物理信息神经网络(Physics-Informed Neural Networks, PINN)是一种在训练过程中嵌入先验物理规律的函数逼近器，具有更好的可解释性和泛化能力。Lai等[57]将动力学系统的方程展开为一个基于先验知识的物理信息项和一个由前馈神经网络构成差异项，用以辨识具有高度非线性的机构系统。Zhai等[58]提出了一种将PINN和4阶龙格库塔(4th-order Runge-Kutta, RK4)数值求解器相结合的非线性动力学系统建模方法(RK4-PINN)，在NODE的框架上，采用数据驱动和物理信息驱动相结合的训练方法，增强了神经网络建模的物理可解释性和预测精度。


图15 基于NODE框架的非线性振动系统辨识方法：(a) RK4-PINN[58]；(b) 子结构神经网络[56]
综上所述，群体智能优化方法和深度学习方法为非线性振动系统辨识提供了充足的理论支撑和丰富的方法，但对复杂高维的非线性振动系统，还有待开展进一步的研究。
1.2.3 最优主动振动控制研究现状
最优主动振动律的求解方法大体上可以分为无模型优化方法和基于模型的优化方法。其中，无模型优化方法又可以分为依赖先验控制经验的控制参数优化，和不依赖先验控制经验的最优控制律求解方法。比例-积分-微分(Proportional- Integral- Derivative, PID)控制律是一种广泛运用的控制技术，其控制参数的选取将直接影响其控制性能。除了传统的经验条件或工程整定方法外，还可以通过遗传算法[59]，PSO算法[60]和差分进化算法[61]对PID控制器的参数进行优化。Guo等[62]使用神经网络实时估计PID控制器的参数，实现了PID控制器的自适应调节。无模型强化学习方法能够不依赖先验控制经验，通过与被控对象和奖励函数构成的强化学习环境进行数据交互，逼近最优控制律。由于振动系统的状态量和控制力都是连续变化的，强化学习算法的状态空间和动作空间也应是连续的。深度确定性策略梯度(Deep Deterministic Policy Gradient, DDPG)算法[63, 64]是一种在状态空间和动作空间都连续的无模型强化学习算法。Zhang等[65]以多自由度线性振动系统为被控对象，以二次线性代价函数为奖励函数，通过DDPG算法训练神经网络控制器。结果表明，所训练的神经网络控制器能够逼近LQR控制器的性能。Qiu等[66]设计了一种基于多代理的异构代理信任区域策略优化强化学习(Heterogeneous-Agent Trust Region Policy Optimization Reinforcement Learning, HR)算法，用以弹簧-柔性梁耦合振动系统的主动控制律求解。
模型预测控制(Model Predictive Control, MPC)是一类基于模型的优化算法。传统的MPC算法以系统的当前状态为最优控制的初始状态，基于预测模型和假设的未来输入，预测未来有限时域内的系统状态，解得最优控制序列并将序列中的第一个元素作为控制指令作用于当前状态[67]。Soloway和Haley[68]使用前馈神经网络对被控对象进行建模作为预测模型，并通过Newton-Raphson方法求解最优控制序列。Peng等[69]提出了一种分布式计算方法，用以加速MPC的最优控制求解。
综上所述，对最优控制问题，已有许多成熟的理论和系统的研究。但对于实际的非线性振动系统最优主动控制问题，仍存在许多的改进空间，亟待进一步的深入研究。
1.3 有待进一步研究的问题
综上所述，尽管关于非线性隔振系统的设计、辨识和控制研究已经受到广泛的研究和关注，但仍存在一些值得完善和探索之处：
(1)目前已有许多关于可调非线性隔振系统的报道，但大部分并未实现隔振系统的实时调控。在半主动调控和主动调控的研究中，也很少基于最优控制的思想去设计和优化控制律。
(2)虽然RK4-PINN方法提供了一种高效且可解释性强的非线性振动系统辨识方法，但该方法难以直接应用于高维复杂非线性振动系统。
(3)传统MPC算法需要实时计算求解最优控制指令，但由于振动系统通常使用较小的时间步长进行仿真，即使预测的有限视域并不长，也会因控制序列过长而难以实时求解。
1.4 本文主要研究内容
以非线性振动系统为被控对象，本文拟在仅有系统激励和响应数据，以及部分先验物理信息的基础上，逆向建立其动力学模型；并通过最优控制原理求解能够有效调节系统和提升系统隔振性能的主动控制律。主要研究内容如下：
(1)Van der Pol振动系统无模型强化学习最优振动控制研究
以van der Pol振动系统为被控对象，通过双延迟深度确定性策略梯度(Twin Delayed Deep Deterministic Policy Gradient, TD3)算法和Soft Actor-Critic(SAC)算法训练神经网络控制器，并分析比对它们的振动控制性能。
(2)主动QZS隔振器辨识与控制研究
　　基于QZS隔振器的激励响应数据和先验物理约束，通过RK4-PINN方法建立其代理动力学模型，并构造与优化算法交互的虚拟环境。随后使用PSO算法和TD3算法与该环境交互，优化PID控制器参数和训练神经网络控制器，并分析比较其作用时主动QZS隔振器的抗负载变化能力和振动抑制性能。
(3)多级非线性隔振系统神经网络模型预测控制器研究
　　在RK4-PINN方法的基础上，提出能够应用于多级非线性隔振系统的子结构物理信息神经网络改进方法，并建立多级非线性隔振系统的代理模型作为预测模型，基于MPC原理训练神经网络最优控制器。随后，在各工况下测试控制器的隔振性能，以检验优化算法的有效性。


第2章 基于强化学习的van der Pol振动系统最优控制研究
基于无模型算法获取非线性振动系统的最优控制律能够规避传统解析方法的复杂计算。深度强化学习算法是一类无模型算法，为研究非线性振动系统的最优控制规律提供了新的思路和方法。本章以具有自激性和非线性阻尼的van der Pol振动系统为被控对象，通过TD3算法和SAC算法的基础上训练神经网络最优控制器，并分析它们在控制代价和振动抑制效果等指标上的综合控制性能。
2.1 LQR最优控制
2.1.1 线性时不变系统的LQR最优控制
线性时不变系统一般可由状态空间方程描述为
		
其中，为系统状态，为系统状态关于时间的一阶导数，为系统外部输入，为系统矩阵，为输入矩阵。
对于无限时长的最优控制问题，设二次代价函数为
		
其中，为控制力，和分别为状态权重矩阵和控制力权重矩阵。
LQR控制器是一种基于二次代价函数和状态空间方程所推导出的最优线性控制器，其控制力输出为
		
其中，，矩阵通过求解代数黎卡提方程(ARE)获得。ARE方程可表示为
		
2.1.2 非线性时不变系统的LQR近似最优控制
非线性时不变系统可由状态空间方程表示为
		
其中，表示非线性系统的动力演化函数。
LQR控制器基于系统矩阵和输入矩阵估计最优反馈增益矩阵，对于非线性振动系统，需要通过线性化处理估计其系统矩阵和输入矩阵。若在处线性化，则有
		
和
		
其中，和分别为系统矩阵和输入矩阵中的元素。
　　非线性振动系统在LQR控制器作用下的系统响应可以表示为		
其中，表示外部激励力。
2.2 基于深度强化学习的最优振动控制原理
2.2.1 强化学习与最优控制
强化学习方法可以描述为智能体在不断与环境交互过程中学习完成特定目标的过程。其控制回路如图21所示。在每一个时间步中，智能体从环境接收状态，做出动作，使环境转移到下一个状态并接收奖励。通过合理设计奖励函数，智能体能够在学习过程中向最优控制策略方向收敛，获得近似最优控制能力。

图21 强化学习控制回路
标准强化学习的目标为最大化预期奖励之和的平均期望，即
		
其中，为基于状态选择动作的策略，为最大化预期奖励之和期望的近似最优策略，表示在策略下状态-动作对的轨迹分布。
在最优振动控制问题中，优化目标为寻找一种控制律使得代价函数最小。使用强化学习方法逼近最优振动控制律，最大化控制过程中的累积奖励，即可最小化代价函数。基于式的二次代价函数，设奖励函数为
		
同时，设控制过程中共历经个时间步，定义控制消耗为
		
非线性振动系统的状态量在空间中连续变化，在控制过程中，通常希望控制力也能连续变化。TD3算法和SAC算法是无模型、异策略的在线演员-评论家算法，能够有效处理具有连续状态空间和连续动作空间的问题，与非线性振动主动控制的需求相匹配。
2.2.2 TD3算法
TD3算法是一种确定策略算法，即TD3算法产生一个确定的动作。该算法由DDPG算法改进而来。具体来说，TD3算法使用6个神经网络，分别为：价值网络和，目标价值网络和，策略网络和目标策略网络。分别记其网络参数为，，，，和。为了防止价值网络高估和提高其训练过程中的稳定性，该算法采用了裁剪双Q学习和目标策略正则化方法，即采用目标价值网络中的最小估值和在使用目标策略网络估计动作时加入随机噪声。此外，TD3网络沿用了经验回放方法，使经验样本满足独立假设并提高样本利用率。
基于TD3算法训练神经网络控制器的算法流程如图22所示。强化学习环境由振动系统动力学方程和奖励函数构成。在训练的每一个控制步中，策略网络接收振动系统当前状态并计算动作(即控制力)，振动系统在动作的作用下推进到下一时刻状态，由奖励函数计算奖励，并将经验元组存入经验池中。随后，从经验池中抽取个经验元组用于更新神经网络参数。目标价值网络和将分别计算状态-动作对的目标价值，并取其中最小值作为实际目标价值。价值网络和分别计算状态-动作对的当前价值，并通过与目标价值的误差更新自身参数。当延迟条件满足时，策略网络朝最大化当前价值的方向更新自身参数，并通过软更新方法更新目标网络参数。神经网络参数更新完成后，推进到下一个控制步，并重复上述步骤，直到训练结束。策略网络即为所训练的神经网络控制器。
状态-动作对的目标价值可表示为
		
其中，为折扣因子，表示正态分布，表示噪声的标准差，为噪声大小的上界。由状态-动作对的当前价值和目标价值构造价值网络的损失函数为
		
策略网络的学习目标为在价值函数的指导下做出最优动作，其损失函数为
		
为了提高训练过程中的稳定性，采用软更新的方式更新目标网络，即
		
其中，为软更新参数。并且采用了延迟更新策略，即策略网络和目标网络仅在评价网络更新次后更新一次。

图22 TD3算法流程图
2.2.3 SAC算法
SAC是一种随机策略算法，即该算法并不直接生成动作，而是产生动作的高斯概率分布，根据概率生成动作。同时，该算法是一类最大熵强化学习算法。最大熵强化学习在标准强化学习的基础上，引入一项熵的正则项，即
		
其中，是温度系数，用以控制熵的重要程度。熵正则项增加了最优策略的随机性，加速了后续策略的学习速率，并减少了陷入局部最优的可能性。具体来说，该算法使用5个神经网络，分别为：价值网络和，目标价值网络和，以及策略网络。策略网络产生动作的均值和标准差。
基于SAC算法训练神经网络控制器的流程如图23所示。在训练的每一个控制步中，策略网络接收振动系统的当前状态并计算动作的概率分布，根据其概率分布随机生成动作(即控制力)，振动系统在动作的作用下推进到下一时刻状态，由奖励函数计算奖励，并将经验元组存入经验池中。随后，从经验池中抽取个经验元组用于更新神经网络的参数和温度系数。神经网络参数和温度系数更新完成后，推进到下一个控制步，并重复上述步骤，直至训练结束。策略网络即为所训练的神经网络控制器。
状态-动作对的目标价值可表示为
		
其中，和分别表示策略网络根据下一时刻计算的动作均值和标准差。同样地，由公式计算价值网络的损失函数。
策略网络的损失函数为
		
SAC算法能够自动调整温度系数，使其能够随着策略的变化而自适应调整，其损失函数为
		
其中，为目标熵。由于无法直接对概率分布求导，实际计算中采用了重参数化采样技巧。即将概率分布分解为，以实现反向梯度传播。

图23 SAC算法流程图
2.3 控制器训练与性能分析
2.3.1 Van der Pol振动系统与强化学习环境
对于一个单自由度的van der Pol振子，其数学表示为
		
其中，为振子质量，为系统刚度，、、为系统的非线性参数，与分别为系统的外激力和控制力。式可化简为
		
其中，，。令，，将式化为状态空间方程形式，即
		
其中，，，。
对式所表示的非线性振动系统，将其在，处近似线性化，系统矩阵和输入矩阵的近似估计分别为
		
和
		
为了控制van der Pol方程中非线性项的大小，令
		
其中，控制非线性项的相对大小，。那么有
		
设环境的状态为
		
Van der Pol振动系统在实际工程中广泛存在，其模型和自激极限环如图24所示。考虑到van der Pol振动系统具有自激性，在训练过程中振子可能向其极限环上移动，达不到预期控制效果，故需要设置终止条件，并在终止时引入惩罚。在本文中，当时，终止训练，并返回一个负奖励。

图24 Van der Pol振动系统：(a) 模型简图；(b) 极限环
设仿真步长为，每轮训练时长为，在自由振动的工况下通过TD3算法和SAC算法进行强化学习振动控制训练。分别设状态权重矩阵和控制权重矩阵为
		
根据近似估计的和以及给出和，依照2.1节的内容，可以求解van der Pol振动系统的反馈控制矩阵和LQR控制器作为参考控制器。令惩罚系数为-100，其余环境参数和强化学习超参数分别如表21和表22所示。随后，在无外力扰动的工况下训练神经网络控制器。
表21 环境参数
参数	含义	值	单位
m	质量	1	kg
c	阻尼	1	kg/s
k	刚度	100	kg/s2
l	非线性参数	1	kg·m-2·s-1
e	限制参数	0.05	1
ts	仿真步长	0.01	s
Ttrain	仿真时长	10	s
x1(0)	初始位移	0	m
x2(0)	初始速度	±1	m/s
表22 强化学习超参数
名称	符号	值或函数名
优化器	\	Adam
学习率	a	1×10-4
折扣因子	g	0.99
经验池大小	\	2×106
隐藏层层数	\	2
隐藏层维数	\	256
经验批量大小	N	32
非线性激活函数	\	ReLU
软更新参数	G	0.005
噪声标准差	s	0.1
噪声上界	d	0.3
TD3算法延迟参数	D	2
最大训练轮次	\	300

2.3.2 训练过程
训练过程中，TD3控制器和SAC控制器每一轮的累积奖励随训练轮次的变化如图25所示。随着训练轮次的增加，TD3控制器和SAC控制器每一轮次获得的累积奖励逐渐上升，逼近LQR控制器产生的消耗并在其下方振荡。其中，SAC控制器在训练过程中收敛速度更快，收敛后回合累计奖励振荡幅度较小；TD3控制器最终所获得的轮次累积奖励更大，但在收敛后仍会轮次累积奖励仍会产生较大振荡。

图25 训练过程中轮次累积奖励随训练轮次的变化
2.3.3 控制器性能分析
训练结束后，分别在无外力扰动工况、变频力激励工况和随机力激励工况下测试TD3控制器和SAC控制器对van der Pol振动系统的综合控制性能。
在无外力扰动工况下，设初始状态,，即与训练环境相同。控制结果如图26所示。可见，相较于无控状态，基于无模型算法训练的两种神经网络控制器能够有效地抑制van der Pol振动系统的振动，且能够接近基于模型的算法所求解LQR的控制效果。在动态过程中，相较于TD3控制器，SAC控制器作用下，振子的相轨线更贴近LQR控制器；而在稳态过程中，SAC控制器作用下的振子仍然有小幅震荡。由图26(f)可见，在进入稳态后，SAC控制器的输出并不平滑，且进入稳态后仍有一定的控制力输出；与之相对，TD3控制器的输出较为光滑，且进入稳态后输出几乎接近0N。图27展示了无外力扰动工况下各个控制器的控制消耗。可见，在该工况下，TD3控制器的消耗低于SAC控制器，但TD3控制器在状态上的消耗较大，而SAC控制器在控制力输出上的消耗较大。这是因为SAC控制器学习了一个随机策略，其根据所计算的概率密度选取控制力；而TD3控制器学习了一个确定策略，其根据当前状态直接计算控制力。总之，在该工况下，TD3控制器和SAC控制器的控制消耗略高于LQR控制器，但这两种基于无模型算法所训练的神经网络控制器的综合控制性能已经接近LQR控制器。

图26 无外力扰动工况下振动抑制效果：(a) 无控时位移；(b) 无控时速度；(c) 控制器作用下位移；(d) 控制器作用下速度；(e) 控制器作用下相图；(f) 控制器输出力
检验变频力激励工况下控制器的控制性能。定义变频力激励信号为
		
其单位为N，频率变化范围为从0.5Hz到5Hz。在零初始状态下使用该信号对van der Pol振动系统激励10s，系统的位移和速度响应如图28所示。相较于无控情况，基于无模型算法训练的TD3控制器和SAC控制器在不同于训练工况的环境下仍能有效地抑制振动。在主动控制的作用下，系统展现出了与正阻尼线性系统相似的特性。在0.5Hz到1.85Hz的低频区域(0s~3s)，TD3控制器和SAC控制器控制下的位移响应峰值和速度响应峰值高于LQR控制器控制下的响应。随着外激励力频率的增加，TD3控制器和SAC控制器的振动抑制效果逐渐逼近LQR控制器。控制过程中，控制力和控制消耗如图29所示。可以发现，TD3控制器输出的控制力更为平滑，而SAC控制器的在控制力上的消耗较高。这仍可由前文所提到理由解释。这两种控制器表现出与LQR控制器趋同的控制力输出趋势，且三者在控制消耗方面的差异并不显著。

图27 无外力扰动工况下控制消耗
检验随机力激励工况下控制力的控制性能。定义随机力激励信号为
		
其单位为N，其表示随机力信号符合标准正态分布，且下界为-5N，上界为5N。在零初始条件下使用该信号对van der Pol振动系统化激励10s，系统的位移和速度响应如图210所示。同时，定义位移平方误差为
		
并定义速度平方误差为
		
　　在控制器作用下系统响应的平方误差如图211所示。可见，在随机力激励下，相较于无控情况，TD3控制器和SAC控制器仍能有效地抑制振动。在控制过程中，SAC控制器控制下的位移平方误差和速度平方误差均小于TD3控制器和LQR控制器。控制过程中，控制力和控制消耗如图212所示。在随机力激励下，SAC控制器输出的控制力表现出较为明显的振荡且不平滑，而其他两种控制器输出的控制器则较为光滑。同时，SAC控制器的控制消耗最高，且在控制力上存在大量消耗。

图28 变频力激励工况下系统响应：(a) 无控时位移；(b) 无控时速度；(c) 控制器作用下位移；(d) 控制器作用下速度

图29 变频力激励工况下控制器控制力与控制消耗：(a) 控制力；(b) 控制消耗

图210 随机力激励工况下系统响应：(a) 无控时位移；(b) 无控时速度；(c) 控制器作用下位移；(d) 控制器作用下速度

图211 随机力激励工况下系统响应平方误差：(a) 位移平方误差；(b) 速度平方误差
综上，在训练工况和两种测试工况下，TD3控制器和SAC控制器这两种基于无模型强化学习算法训练的神经网络控制器均能有效抑制van der Pol振动系统的振动，且逼近LQR控制器的控制性能。

图212 随机力激励下控制器控制力与控制消耗：(a) 控制力；(b) 控制消耗
2.4本章小结
本章基于两种无模型强化学习方法研究了van der Pol振动系统的最优控制问题。基于TD3和SAC两种深度强化学习算法，在无外力扰动环境下训练了2种神经网络控制器，并以基于模型求解的LQR最优控制器为参照，分别在无外力扰动工况、变频力激励工况和随机力激励工况下对控制器性能进行了测验，主要结论如下：
(1) 基于无模型深度强化学习算法训练后的2种神经网络控制器性能均能逼近基于先验知识和模型求解的LQR控制器。这表明在难以获取被控对象精确模型或解析求解最优控制律较为困难时，无模型深度强化学习方法具有有力的应用前景。
(2) 在不同的工况下，TD3控制器和SAC控制器均能逼近LQR控制器的控制消耗。且在无外力扰动工况下训练的神经网络控制器在变频力激励和随机力激励工况下均能有效工作。这展示了所训练的神经网络控制器对环境的适应能力和在其他工况下工作的有效性。
(3) TD3控制器输出的控制力较为平滑，且控制消耗更小；而SAC控制器在特定工况下表现出更好的振动抑制性能。这表明需要权衡使用这两种控制器，即TD3在控制力平滑性和控制消耗方面表现出色，而SAC在一些特定工况下拥有更好的振动抑制性能。


第3章 主动准零刚度隔振器辨识与控制研究
主动QZS隔振器通过补偿主动力对抗负载变化，以维持系统的准零刚度特性。若其主动控制律使系统在某种意义上是最优的，将能进一步提升其抗负载变化的能力和隔振性能。第2章的研究表明，深度强化学习方法是近似求解最优控制律的有力工具，且不依赖先验模型经验。但是，强化学习方法需要与环境交互，而实际工程情况中未必能够有效地建立环境中的动力学模型。本章主要研究一种结合数据驱动和物理信息驱动相结合的QZS隔振器动力建模方法，根据其输入激励和输出响应逆向搭建其动力模型，构建虚拟环境，并结合TD3算法和PSO-PID算法，研究主动QZS隔振器的抗负载变化能力和隔振性能。
3.1 主动QZS隔振器代理动力学模型辨识
3.1.1 主动QZS隔振器动力学模型
主动QZS隔振器由竖直弹簧、侧弹簧、作动器及其他附件构成。由被隔离负载的重力将其侧弹簧压缩至水平位置，使隔振器处于准零刚度状态。主动QZS隔振器的结构如图31所示。

图31 主动QZS隔振器结构：(a) 效果图；(b) 结构简图
定义载荷的位移为，扰动的位移为，相对位移为，其动力学方程为
		
其中，为负载的质量，为系统阻尼，为重力加速度，为输入系统的外激力，为QZS隔振器的系统恢复力，其大小为
		
其中，为竖直弹簧刚度，为水平弹簧刚度，为水平弹簧原长，为侧弹簧在水平方向的投影长度，且满足。将重力项并入恢复力项并将其无量纲化，有
		
其中，,,,。将恢复力对位移求导，得到刚度与位移的关系，即
		
由准零刚度条件，得到准零刚度参数关系。将在处泰勒展开，有
		
其中，三次项和五次项的系数分别为和。令，，，同时定义无量纲频率。归一化后的系统动力学方程为
		
其中，和分别为无量纲位移关于无量纲时间的一阶和二阶导数，。通过状态空间方程表示系统的动力学方程，有
		
		
其中，,。
3.1.2 混合驱动的代理动力学模型
对于一个在时间上连续、有外部输入的动力学系统，可以通过一阶微分方程表示为
		
其中，为状态向量，为外部输入，，表示动力学系统的演化函数。如果动力学系统在时刻的状态，外部输入函数和演化函数已知，那么可以得到系统任意时刻的状态，即
		
相反地，在系统辨识任务中，需要通过一段有限且离散的状态和外部输入信号，尽可能精确的求解演化函数。PINN在神经网络的基础上，施加了相应的先验限制条件，提升了神经网络精确拟合具有复杂非线性演化函数的能力。RK4-PINN为非线性动力学系统建模提供了透明且可解释的框架。将PINN单元嵌入RK4求解器中，通过自动微分工具计算系统的参数，并在损失函数中添加有关时不变参数的软约束。定义代理模型的演化函数作为演化函数的近似，神经网络为代理模型演化函数的一个组成部分，其中，为神经网络参数。若时刻的状态向量和外部输入已知，那么可以计算出时刻的状态向量的预测值，即
		
其中，为时间步长，表示RK4求解器。设时刻状态向量真值为，使用平均平方误差(MSE)定义预测损失，即
		
其中，表示从训练集中抽取的批量大小。
自动微分技术能够计算特定函数对其输入的偏导数值。若动力学演化函数中的时不变参数能够通过偏微分过程得到，则这些参数估计值则可由自动微分计算，记这些估值为，则有
		
其中，表示基于先验经验通过自动微分技术计算这些估值的映射。在任何情况下这些参数都应该是相同的，因此，通过变异系数定义物理损失为
		
其中，是一个小的正数以防分母为0或过小，且有
		
　　此外，若能够从先验经验中获知这些参数的正负，可以定义符号损失为
		
		
其中，为系统时不变参数的个数，表示根据先验经验所知晓的参数正负。因此，总损失可表示为
		
代理动力学模型的训练过程中采用变学习率法，神经网络的参数更新公式为
		
其中，为当前训练轮次，为初始学习率，为衰减系数。
3.1.3 主动QZS代理动力学模型建模
由公式和公式可知，搭建QZS隔振器的代理动力学模型，本质上是求解和。但在偏微分计算中，与无法分离。更进一步，假设先验经验并不知晓的准确表达式，仅知晓可按照公式通过泰勒展开近似。基于数据驱动和物理信息混合驱动方法训练QZS隔振器代理动力学模型的计算流程如图32所示。使用神经网络替换公式中含有未知参数和动力学关系的部分，那么QZS隔振器代理动力学模型的演化函数可以表示为
		

图32 QZS隔振器代理动力学模型训练流程图
若采用三阶近似对进行约束，则通过自动微分估计以下参数
		
其物理损失函数和符号损失函数分别为
		
若采用五阶近似对进行约束，则通过自动微分估计以下参数
		
其物理损失函数和符号损失函数分别为
		
3.1.4 代理动力学模型预测精度检验
　　确定QZS隔振器系统参数，设为0.02，为0.75。使用功率谱密度(Power Spectral Density, PSD)为的平均随机白噪声信号作为外激力激励QZS隔振器，以100无量纲频率采集512无量纲时间的位移信号，速度信号和外激力信号。设为一个拥有3个隐藏层，隐藏层维数为64，激活函数为tanh的前馈神经网络。令损失权重系数为，为1，为10。设初始学习率为，折扣因子为0.9908，最大学习轮次为500，批量大小为64。分别采用三阶近似约束和五阶近似约束对QZS代理动力学模型进行训练。以训练前初始代理动力学模型在训练集上的误差为基准，训练过程中的损失曲线的变化如图33(a)所示。训练结束后，得到3阶SDM和5阶SDM。以5阶SDM在训练集上最终收敛的误差为基准，代理动力学模型在各测试集上误差如图33(b)所示。可见，在训练初期，损失曲线表现出一定程度的振荡。随着训练轮次的增加，损失曲线逐渐收敛。训练结束后，5阶SDM在训练集和各测试集上的误差均小于3阶SDM。 

图33 代理动力学模型的预测误差：(a) 训练过程中的损失曲线；(b) 测试集上预测误差
对代理动力学模型在时域和频域上的动力学预测进行检验。定义外部位移扰动
		
其中，为外部扰动的幅值。当系统进入稳态后，设载荷的位移峰值为，定义位移传递率为
		
　　分别用PSD为的高斯随机白噪声信号作为力激励；为0.036，为0.06的定频外部位移扰动；为0.1，为0.085的定频外部位移扰动；以及为0.024，的扫频外部位移扰动对真实QZS隔振器及其代理动力学模型进行激励。其位移响应、相图和位移传递率曲线如图34所示。可以发现，代理动力学模型在各种激励下都能够较为精准的反应真实动力学模型的动力响应。在位移传递率图像中，代理动力学模型展现出与真实QZS隔振器相似的跳变现象。而在各类激励下，相较于3阶SDM，5阶SDM的响应与真实QZS隔振器更为接近。这说明，代理动力学模型在时域和频域均能较为精确的反应真实动力学模型的动力学特性，且引入的先验物理信息越多，所训练的代理动力学模型更为精确。

图34 代理动力学模型的时域和频域响应：(a) 随机力激励下位移响应，PSD = 4×10-5；(b)定频位移扰动下位移响应，，W = 0.06；(c) 定频位移扰动下相图，，W = 0.085；(d) 位移传递率，
3.2 主动控制律优化
3.2.1 奖励函数和目标函数
关于最优控制问题，第2章中已有较为充足的论述。对QZS隔振器的主动振动控制，希望其在抑制振动的同时使输入的控制力尽可能的小，同时满足一定的快速性要求。基于这种准则，文献[66]给出了一种柔性梁耦合系统主动振动控制的奖励函数。在此基础上，QZS隔振器的主动振动控制的奖励函数可以设计为
		
其中，为主动控制力，为状态权重矩阵，为控制力权重系数，，和为奖励函数权重系数，为时间步长，为奖励函数。目标函数为
		
其中，为控制过程中所经历的时间步。
3.2.2 基于PSO算法的PID控制器
PSO算法[43]是一种基于种群协作的随机搜索算法。PSO算法从随机粒子出发，在迭代过程中根据个体粒子的历史最优解和粒子群的全局最优解更新粒子在解空间中的位置。PSO算法的迭代公式如下
		
其中，为粒子编号，和表示粒子在解空间中的位置和速度，表示迭代次数，惯性权重，为局部学习因子，为全局学习因子，和为0~1间的随机数，表示个体粒子的历史最优解，表示粒子群的全局最优解。
文献[35]在寻优任务中成功运用了一种基于sigmod函数的改进PSO算法。在他们工作的基础上，本章在算法中引入了“末位淘汰”机制，即在迭代过程中，将在目标函数下价值最低的部分粒子在解空间中随机初始化，以提高算法的全局最优搜索能力。即
		
其中，表示在点完成所优化的任务的目标函数值，为个体粒子历史最优解的价值，为粒子群大小，和为0~1间的随机数，和分别为解空间的下界和上界，和分别为粒子速度的下界和上界。
PID控制器是一种最经典，最简单和广泛运用的控制器。其通过反馈误差，误差的积分量和误差的变化率输出控制律。若采用位移反馈，PID控制律可以表示为
		
其中，为位移参考信号，为误差信号，为比例项，为比例项，为微分项。PID参数的选取很大程度上依赖于经验。采用PSO算法，基于PID控制这一先验控制经验，在代价函数的指导下搜寻最优参数，以近似逼近最优控制目标。PSO算法采取实数编码，即在搜索最优PID参数的过程中，解空间为PID参数的三维实数空间，即
		
对振动控制任务而言，位移参考信号恒为零。
3.2.3 基于虚拟环境训练近似最优控制器
3.1.4节表明，代理动力学模型能够准确反应真实QZS隔振器的动力学特性，且5阶SDM更为准确。本节采用所训练的5阶SDM和奖励函数(目标函数)共同构成训练控制器的虚拟环境。并使用具有“末位淘汰”机制的改进PSO算法优化PID控制器参数，以及采用TD3算法训练神经网络控制器，以最大化控制过程中目标函数。优化流程如图35所示。

图35 主动QZS隔振器控制律优化流程
给予载荷一个初始无量纲位移，通过带有“末位淘汰”机制的PSO-PID法和TD3强化学习算法分别求解近似最优控制律。在使用PSO-PID法求解时，设解空间的下界为，上界为，粒子在解空间中运动速度的下界和上界分别为和，惯性权重从0.9线性衰减至0.4，种群大小为40，淘汰率为10%（即每一回合初始化目标函数下价值最低的10%粒子），其余设置与文献[35]中相同。在运用TD3算法求解时，采用有2个隐藏层，隐藏层维度为256，激活函数为tanh的神经网络作为策略网络；采用有3个隐藏层，隐藏层维度为256，激活函数为ReLU的神经网络作为价值网络。设无量纲控制力范围为，计算目标价值时添加的噪声的标准差为最大动作值的2%，噪声上界为最大动作值的5%，神经网络的学习率为0.002，折扣因子为0.98，软更新参数为0.02，延迟参数为3。令状态权重矩阵中元素为10，为0.01，控制力权重系数为0.01，奖励函数权重系数，和分别为120，1和1，回放缓冲区的大小为，批量大小为128。
分别使用PSO算法和TD3算法迭代200回合。优化过程中，粒子群的全局最优解和TD3算法的回合累计奖励变化曲线和PID的参数变化曲线如图36所示。寻优结束后，，，分别收敛至44.80，0和10.02。

图36 训练过程：(a) 目标函数值随训练轮次的变化曲线；(b) PID参数寻优曲线
在真实的QZS隔振器上以相同的工况进行测试。在这一控制任务中，PSO-PID控制器的目标函数值为59.77，TD3控制器的目标函数值为49.52。可见，不论是依赖于先验控制经验的PSO-PID方法和完全依据奖励函数的指导去搜索最优控制律的TD3算法，都能够求得一个近似最优控制律，尽管在这一工况下PSO-PID控制器在所定义的目标函数下的表现较TD3控制器略优。
3.3 主动QZS隔振器性能分析
对QZS隔振器，引入主动控制的目的是使其具备对抗负载变化的能力，并进一步增强其隔振性能。上一节中根据PSO算法和TD3算法在虚拟环境中训练了两种主动控制器，本节将进一步分析其作用在真实QZS隔振器上时，在变负载工况下和其他情形下的隔振性能。
3.3.1 变负载工况
当载荷质量变化时，QZS隔振器的平衡位置也随之发生变化。考虑将载荷从新的平衡位置移动到原零平衡位置附近的情形，令负载变化量分别为-5%，-3%，3%，5%。使用PSO-PID控制器和TD3控制器完成这一控制任务。位移响应和控制力输出如图37所示。

图37 无外部扰动时变负载工况下QZS隔振器的主动调控过程：(a) 负载减小时调控的位移响应；(b) 负载增加时调控的位移响应；(c) 负载减小时调控的控制力；(d) 负载增加时调控的控制力
当时，PSO-PID控制器控制过程的目标函数值为50.18，而TD3控制器为44.13；当时，PSO-PID控制器控制过程的目标函数值为58.69，而TD3控制器为48.99。可见，在变负载条件下，这两种控制器均能较快地将载荷调节至零平衡位置附近，并对变化的负载进行补偿，但PSO-PID控制器在目标函数意义下的控制性能较TD3控制器稍优。
设有为0.1，为0.085的定频外部位移扰动在变负载工况下作用于主动QZS隔振器，载荷位移响应分别如图38和图39所示。可见，在无控情形下，负载发生变化后，载荷位移响应明显放大。引入主动控制后，位移响应被明显抑制，且TD3控制器表现出更好的振动抑制性能，且基本消除负载变化的影响。

图38 负载减小工况下载荷位移响应：(a) (b) 无控时隔振效果对比；(c)(d) TD3控制器与PSO-PID控制器隔振效果对比；(e)(f) TD3控制器作用下负载减小与负载未变化的隔振器隔振效果对比

图39 负载增大工况下载荷位移响应：(a) (b) 无控时隔振效果对比；(c)(d) TD3控制器与PSO-PID控制器隔振效果对比；(e)(f) TD3控制器作用下负载增大与负载未变化的隔振器隔振效果对比
3.3.2 其他隔振情形
使用PSD为的高斯随机白噪声信号作为力激励对主动QZS隔振器持续激励1000无量纲时间，并在为400时开启主动控制，其振动抑制效果如图310(a)所示。在控制过程中，PSO-PID控制器的目标函数值为-27.61，而TD3控制器的目标函数值为6.99。可见，该随机力激励下，引入主动控制能够大幅提高QZS隔振器的隔振性能，且在目标函数意义下，TD3控制器的性能较PSO-PID控制器更为优越。
令为0.024，，以式定义的外部位移扰动测试主动QZS隔振器的位移传递率律，如图310(b)所示。可见，在引入主动控制后，QZS隔振器在低频段的位移传递率明显下降，且以TD3控制器作为主动控制器的QZS隔振器在该频段的隔振效果更为优异。

图310 主动QZS隔振器振动抑制效果：(a) 随机力激励，PSD=1×10-4；(b) 位移传递率，
3.4 本章小结
本章提出了一种将数据驱动的系统辨识和最优控制律求解相结合的方法，用以主动QZS隔振器的主动控制律优化。基于QZS隔振器的输入激励和输出响应，通过数据驱动与物理信息驱动相结合的算法，逆向搭建了其代理动力学模型。将代理动力学模型与奖励函数整合为虚拟环境，训练了近似最优控制器，并将其用于真实QZS隔振器的主动控制中。主要结论如下：
(1) 数据和物理信息混合驱动的辨识算法所训练的代理动力学模型能够准确地反应真实QZS隔振器的动力学响应。且引入的先验物理经验越多，模型越准确。
(2) 通过代理动力学模型构成的虚拟环境训练控制器的方法是可行的。在虚拟环境中训练的控制器能够对原QZS隔振器在各个工况下进行有效控制。
(3) 引入主动控制后，QZS隔振器具备了对抗负载变化的能力，且隔振性能得到大幅提升。

第4章 多级非线性隔振系统神经网络模型预测控制研究
第2章主要介绍了无模型强化学习算法在非线性振动系统最优控制中的应用，而第3章中探讨了RK4-PINN方法用于QZS隔振器代理动力学模型的逆向建模，并搭建了虚拟环境用于基于无模型优化算法的控制器训练。然而，该方法难以直接应用于多级非线性振动系统。若能获取被控对象的动力学模型，模型预测控制不失为一种基于模型的最优控制求解方法。本章主要研究一种基于模型预测控制的神经网络控制器训练方法，并将RK4-PINN方法从单自由度振动系统推广到多级非线性振动系统。
4.1 多级非线性隔振系统的代理动力学模型
4.1.1 多级非线性隔振系统的动力学建模
将火箭的载荷-箭体系统简化为一个三自由度振动系统，箭体的扰动通过隔振系统传递到有效载荷。QZS隔振器具有高承载力低动刚度的特性。将QZS隔振器简化为三次非线性弹簧，连接箭体与隔振系统，如图41所示。该隔振系统各振子的质量分别为,,；阻尼分别为,,；弹簧刚度分别为,,。令箭体的位移为，各级振子的位移分别为,,，且有，；通过执行器输入的外激力为，控制力为，。定义相对位移,,,，该隔振系统的动力学方程为
		
其中，有
		
和
		
定义标准质量为，标准阻尼为，标准刚度为，标准长度为。令，，,,,，,,,,,。并令
		
可得到该系统的无量纲状态空间方程
		
		
		
其中，,,,,,,,,,。

图41 箭载载荷隔振系统：(a) 简化原理图；(b) 模型图
4.1.2 子结构物理信息神经网络
3.1.2节中介绍了数据与物理信息混合驱动的RK4-PINN方法。然而，对于多级非线性隔振系统，该方法较难施加物理软约束，具有一定的局限性。对于多自由度振动系统，某个振子的响应可能仅与其自身及相邻振子的状态相关。这样的动力学系统可以分散为多个子动力学系统，针对每个子动力学系统分别搭建与之相对应的神经网络。通过搭建子结构物理信息神经网络，降低每一个神经网络所对应的自由度，能够方便的施加物理软约束，将RK4-PINN方法推广到高自由度动力系统，提高系统辨识的精度和物理可解释性。
假设某一动力学系统可被分散为个单元，其某一单元的响应仅与其自身和与其相邻的两个单元的状态相关，即
		
即
		
其中，为该系统的状态，为该动力系统的动力学演化函数，表示子动力系统的编号，表示子动力系统的动力学演化函数。设代理动力学模型的动力学演化函数为
		
其中，表示神经网络，表示神经网络的参数。类似于3.1.2节中的方法，系统在时刻的状态预测值为
		
并采用与式相同的方法定义预测损失。
每个子动力学系统的时不变参数可由自动微分方法估计为
		
并通过变异系数定义物理信息损失为
		
　　符号损失函数和总损失函数与式和式相同。
采用变学习率法训练代理动力学模型，神经网络的参数更新公式为
		
其中，为当前训练轮次，为初始学习率，为衰减系数，为所有神经网络的参数的集合。该辨识方法的原理图如图42所示。

图42 基于子结构物理信息神经网络的代理动力学模型辨识原理图
4.1.3 多级非线性隔振系统的代理动力学辨识
　　由式和式，设多级非线性隔振系统的代理动力学模型为
		
和
		
该系统共有10个时不变参数，即。它们可由自动微分估计为
		
将式代入式和式，即可计算和。基于子结构物理信息神经网络训练多级非线性隔振系统的代理动力学模型的流程图如图43所示。训练过程中，基于当前状态，通过子结构物理信息神经网络组成的代理动力学模型计算当前状态关于的一阶导数，并使用4阶龙格库塔求解器估计下一时刻的状态。比较下一时刻的预测状态与下一时刻真实状态的差值，计算预测误差，构成辨识算法中的数据驱动部分。同时，通过自动微分估计系统参数，计算物理信息损失和符号损失，构成辨识算法中的物理信息驱动部分。最后，将这三项损失按照权重系数加权，计算总损失，并通过优化器更新各个子结构物理信息神经网络的参数。

图43 多级非线性隔振系统代理动力学模型辨识流程图
4.1.4 代理动力学模型预测精度检验
为验证基于子结构物理信息神经网络所建立的代理动力学模型的准确性和普适性，设置两组模型参数进行系统辨识并与其对应的真实动力学模型进行比较。定义模型1(M1)：,,,。定义模型2(M2)：,，其余设置与M1相同。令位移扰动函数恒为零，分别使用PSD为和的均匀随机白噪声信号作为外激力对M1和M2进行激励，并以100无量纲频率为采样频率对位移信号，速度信号和外激力信号进行512无量纲时间的采样。将采样整理为辨识代理动力学模型的训练集。设 为隐藏层数为2，隐藏层维数为128，激活函数为的前馈神经网络。令损失函数权重系数为，为，为，小正数为，初始学习率为，衰减系数为0.9908，最大学习轮次为500，批量大小为64。训练过程中，总损失曲线的变化和所估计的部分参数均值变化如图44和图45所示。可见，在随着训练轮次增加，代理动力学模型在训练集上的总损失逐渐下降并最终收敛；所估计的参数均值逐渐逼近其所对应的真值，参数所对应的标准差也逐渐减小。

图44 辨识过程中M1代理动力学模型：(a) 总损失曲线；(b) 参数预测曲线

图45 辨识过程中M2代理动力学模型：(a) 总损失曲线；(b) 参数预测曲线
对分别对M1和M2的代理动力学模型在时域和频域上的动力学预测进行检验。定义多级非线性隔振系统的位移传递率为
		
分别用PSD为的均匀随机白噪声信号作为力激励；为0.072，为0.1的定频外部位移扰动；为0.024，的扫频外部位移扰动；以及为0.1，的变幅外部位移扰动对M1的真实动力学模型和代理动力学模型进行激励。其位移响应、相图、位移传递率和分岔现象如图46所示。分别用为0.048，为0.1的定频外部位移扰动；为0.3，为0.08的定频外部位移扰动；为0.024，的扫频外部位移扰动；以及为0.085，的变幅外部位移扰动对M2的真实动力学模型和代理动力学模型进行激励。其位移响应、相图、位移传递率和分岔现象如图47所示。可见，M1和M2的代理动力学模型均能准确地预测其对应真实动力学模型的时域和频域响应，并精确刻画跳变、多周期、分岔等非线性动力学现象。

图46 M1代理动力学模型：(a) 随机力激励下位移响应，PSD = 1×103；(b)定频位移扰动下相图，，W = 0.1；(c) 位移传递率，；(d) 分岔图，W = 0.1

图47 M2代理动力学模型：(a) 定频位移扰动下位移响应，，W = 0.1；(b)定频位移扰动下相图，，W = 0.08；(c) 位移传递率，；(d) 分岔图，W = 0.085
4.2 基于代理动力学模型的神经网络模型预测控制器
4.2.1 最优模型预测控制
模型预测控制利用被控系统动力学模型预测系统在一定控制作用下一段时间内的动态响应，在此基础上根据给定的约束条件和性能要求求解最优控制序列并实施控制作用。定义瞬时代价函数为，则模型预测控制的代价函数可表示为
		
其中，为起始时间，为模型预测控制的视距。在使用简单数值积分方法计算时，该式可近似为
		
其中，为起始时间步，为视距步，。
若将式中所示的线性二次性能最优指标作为模型预测控制的代价函数，则可定义其瞬时代价函数为
		
同时，将3.2.1节中所使用强化学习奖励函数转换为瞬时代价函数，则可得到
		
其中，，和为瞬时代价函数的权重系数。
4.2.2 神经网络最优控制器
定义神经网络控制器为
		
其中，为神经网络的参数。训练过程中，每回合随机生成大小为的初始状态集，，表示初始状态空间。训练结束后，随机生成大小为的初始状态集作为测试集。训练过程中，使用代理动力学模型作为预测模型，对未来状态进行预测，且令外激力和位移扰动函数恒为零，即
		
根据模型预测控制的原理，代价函数可表示为
		
通过梯度下降法更新神经网络控制器参数，即
		
其中，为学习率。控制器训练流程如图48所示。在每一个预测步中，神经网络控制器根据当前状态计算控制力，并基于代理动力学模型计算下一个状态。同时，计算瞬时代价函数值并将其累加入代价函数。达到预测视距后，通过优化器更新神经网络控制器的参数。训练结束后，在真实动力学模型上测试控制器的性能，测试代价函数可表示为
		

图48 神经网络最优控制器训练流程图
4.2.3 神经网络控制器训练
设为隐藏层层数为2，隐藏层维数为128，激活函数为tanh的前馈神经网络。令初始状态空间的上界为，下界为，无量纲控制力的输出范围为，初始状态集的大小为32，测试集的大小为128，学习率为。当选择作为瞬时代价函数时，令，，；而当选择作为瞬时代价函数时，令，，，，。令最大训练轮次为10000，无量纲积分时间步长为0.01。使用4.1.4节中所辨识的M1的代理动力学模型作为模型预测控制的预测模型，分别令，以最小化式所示的代价函数为优化目标对控制器进行训练，得到和。
对M1的真实动力学模型进行近似线性化处理，获取其系统矩阵和输入矩阵，并求解LQR控制器的反馈增益矩阵。同时，定义非线性反馈控制为
		
其中，为的参数，且有
		
使用3.2.2节中具有“末位淘汰”机制的PSO算法对非线性反馈控制器进行优化。令的解空间下界为，上界为。粒子在解空间中的运动速度的下界为，上界为，其余参数设置与3.2.3节和文献[35]中相同。
以测试集为初始状态集，为瞬时目标函数，使用该方法在M1的真实动力学模型上对进行优化求解，最终解得，，，，，，。LQR控制器，PSO-NFC控制器，神经网络控制器和在测试集上的表现如表41所示。当为500时，神经网络模型预测控制器在训练过程中不收敛。当为800和1000时，神经网络模型预测控制器在训练过程中均收敛。且当为1000时，在测试集上的性能已经逼近基于已知模型信息和最小化泛函求解的LQR控制器。而当为800或1000时，在测试集上的性能都已超过在真实动力学模型上训练的PSO-NFC控制器。这说明本文所提出的以代理动力学模型为预测模型，通过模型预测控制原理训练神经网络控制器以逼近最优控制律的方法是可行且有效的。
表41 各控制器以测试集为初始状态在M1真实动力学模型上的目标函数值
	H = 500	H = 800	H = 1000	LQR	PSO-NFC
JLQR	不稳定	0.499	0.495	0.494	\
JHR	不稳定	0.793	0.799	\	0.855
4.3多级非线性隔振器的主动隔振性能
设M1的初始状态为，分别使用LQR控制器，PSO-NFC控制器，和对M1的真实动力学模型进行控制，有效载荷的位移响应和控制器的控制力输出如图49所示。可见，对有效载荷的位移响应控制和控制力输出与LQR控制器十分接近。在这一控制任务中，LQR控制器在意义下的控制消耗为2.926，而的控制消耗为2.999。这说明基于模型预测控制原理，在有限视距和使用代理动力学模型作为预测模型所训练的神经网络近似最优控制器，能够逼近基于真实动力学模型参数和在无限视距条件下通过最小化泛函所求解的LQR最优控制器。同时，在这一控制任务中，PSO-NFC控制器在意义下的控制消耗为2.886，而的控制消耗为2.763。这说明在最优控制律难以解析求解时，相较于通过群体智能优化算法去搜索一组反馈控制器的参数，基于模型预测控制原理训练神经网络控制器可以更为有效地逼近最优控制律。此外，相较于，更快地将有效载荷控制到零平衡位置附近，体现了设计目标函数时所考虑的快速性要求。

图49 具有初始状态的多级非线性隔振系统的主动控制：(a) 有效载荷位移响应；(b) 控制力
使用PSD为的高斯随机白噪声信号作为外激力对隔振系统进行激励，持续1000无量纲时间，并在为315时打开主动控制器，有效载荷的位移响应如图410(a)所示。可见，在高斯白噪声激励下，引入主动控制能够大幅提升多级非线性隔振系统的隔振性能，且能够快速将有效载荷调节至零平衡位置附近，而在LQR控制器和的控制下则表现出明显的超调现象。在开启主动控制后，在意义下，LQR控制器的控制消耗为3.977，的控制消耗为4.098；而在意义下，PSO-NFC控制器的控制消耗为3.519，的控制消耗为3.145。这说明在高斯白噪声激励这一工况下，依然能够逼近LQR控制器的控制性能，而的控制性能仍优于PSO-NFC控制器。
令，为0.024，在位移扰动函数作用下测试多级非线性隔振系统的主动隔振性能，其位移传递率如图410(b)所示。可见，在引入主动控制后，多级非线性隔振系统在低频范围内的位移传递率明显下降，且跳变现象消失。在被控隔振条件下，位移传递率在为0.290处达到41.096的峰值。而在主动隔振条件下，对振动的抑制作用最为优异，其位移传递率峰值频率增大到，而峰值下降至。

图410 多级非线性隔振器隔振性能：(a) 随机力激励，PSD = 1×10-4；(b) 位移传递率，
4.4 本章小结
对具有QZS特性的多级非线性隔振系统，本章提出了一种基于数据驱动的将系统辨识和模型预测控制相结合的方法，求解其近似最优控制律。首先，使用子结构物理信息神经网络方法，对多级非线性隔振系统进行代理动力学模型建模。随后，将其代理动力学模型作为预测模型，基于模型预测控制原理分别训练了两种不同代价函数意义下的神经网络近似最优控制器。最后，测试这些控制器在各个工况下的振动抑制性能。主要结论如下：
(1) 通过子结构物理信息神经网络，将RK4-PINN方法从单自由度振动系统推广到多级振动系统。所训练的代理动力学模型能够准确地复现出真实动力学模型的时域和频域响应，以及跳变现象、多周期现象和分岔现象等非线性动力学现象。
(2) 所训练的代理动力学模型能够作为预测模型训练神经网络控制器。合理设定预测控制的视距，所训练的神经网络控制器在各个工况下均能够有效地抑制原隔振系统中有效载荷的振动，且逼近代价函数意义下的近似最优控制律。
(3) 相较于，的响应更为迅速，超调量更小。这反映了代价函数设计中所考虑的快速性。同时，也说明本章所提出的优化方法能够支持用户自主设计难以通过解析法求解最优控制律的代价函数，以实现用户所期望的控制效果。
结论与展望
结论
本文以非线性振动系统为研究对象，基于数据驱动方法，分别研究了非线性振动系统的系统辨识、无模型最优控制和基于模型的最优控制问题。首先，针对具有自激特性的van der Pol振动系统，以二次线性代价函数为优化函数，使用TD3和SAC两种无模型强化学习方法训练神经网络控制器，有效抑制了该自激系统的振动。随后，针对准零刚度(QZS)隔振器，在无法直接获取其动力学方程的情形下，运用基于数据和物理信息混合驱动的RK4-PINN方法，通过QZS隔振器的输入激励和状态响应，逆向搭建了其代理动力学模型。在此基础上，搭建了与无模型优化算法交互的虚拟环境，并通过PSO和TD3两种无模型优化算法，分别实现了PID控制器的参数寻优和最优神经网络控制器的训练。最后，针对具有QZS特性的多级非线性隔振系统，基于RK4-PINN方法进行改进，发展了子结构物理信息神经网络方法，将原方法推广到多级振动系统，获取了多级非线性隔振系统的代理动力学模型。将其代理动力学模型作为预测模型，基于模型预测控制原理，训练了神经网络模型预测控制器，规避了传统模型预测控制方法所需的实时求解。主要工作及结论如下：
一、基于数据和物理信息混合驱动的非线性振动系统辨识
本文对非线性振动系统的逆向建模开展研究。基于被控对象的输入激励和输出响应，以及部分先验的物理经验约束，通过数据驱动和物理信息驱动相结合的混合驱动方法，搭建了QZS隔振器的代理动力学模型。其代理动力学能够准确地复现原模型的时域和频域响应，且引入先验物理信息越多，所辨识的代理动力学模型约精确。对于多级非线性隔振系统，在RK4-PINN方法的基础上，改进开发了子结构物理信息神经网络方法。该方法提出将高维动力系统分散为多个子动力系统，并用相应的子神经网络与之对应。这样可以降低每一个神经网络所对应的自由度，更为便捷地添加物理软约束。结果表明，该方法能够精确地反应原模型的时域和频域响应，且展现出相似的跳变、多周期和分岔现象。所辨识的代理动力学模型的精度足以支持其代替原模型与无模型优化算法进行数据交互，以及作为基于模型算法的参照模型。
二、基于数据驱动的非线性振动系统最优控制
本文运用无模型优化算法和基于模型的优化算法，求解非线性振动系统的近似最优控制率。在研究van der Pol振动系统的主动振动控制时，基于TD3和SAC两种无模型强化学习算法训练的神经网络控制器均能有效抑制该自激系统的振动，其控制性能能够逼近基于模型求解的LQR控制器，验证了无模型强化学习算法求解最优控制问题的有效性。研究主动QZS隔振器的最优控制时，在其代理动力学模型构成的虚拟环境上优化的PSO-PID控制器和训练的TD3控制器均能有效提升QZS隔振器的隔振性能，并使其具备对抗负载变化的能力。在多级非线性隔振系统的主动控制的研究中，以其代理动力学模型为预测模型，基于模型预测控制原理训练神经网络控制器，实现了在不同的代价函数意义下的近似最优控制。该方法规避了传统模型预测控制的实时求解，实现了长视距下的模型预测控制优化，大幅提升了控制器的快速响应性能。引入神经网络控制器后，多级非线性隔振系统的隔振性能得到显著提升。
展望
本文基于数据驱动方法研究非线性振动系统的辨识与控制问题。使用RK4-PINN方法和基于其改进的子结构物理信息神经网络方法，分别实现了对单自由度QZS隔振器和多级非线性隔振系统的系统辨识，并通过PSO算法，强化学习算法和模型预测控制原理优化或训练了响应的近似最优控制器。但在研究深度和广度方面仍有不足之处，例如：
(1) 本文仅对单自由度和多自由度振动系统展开了系统辨识研究。而对在空间上连续的结构，如梁、板、壳等，有待进一步开展其动力辨识研究。
(2) 本文仅对单自由度和多自由度振动系统展开了全状态观测下的控制研究。而实际工程中往往会出现状态观测不全，或空间连续结构状态量过高的情形，即有待进一步开展非全状态量观测下的最优控制研究和高维动力系统的动力学降维研究。
(3) 本文仅在仿真环境中研究了非线性振动系统的辨识与最优控制问题，缺乏实际实验的验证和支撑，后续将开展隔振系统的实物设计和搭建实验平台，进行所提出的理论算法的实际测试和验证。


致   谢
暂无。

蒋纪元
2025年4月21日
于犀浦校区3号教学楼


参考文献
[1]王珏,窦唯,杜家磊,等.液体火箭发动机涡轮泵振动问题研究现状及展望[J].推进技术,2025,46(04):19-34.
[2]Zhao X, Wang Z, Zheng G. Knowledge-based integrated optimization design of agile imaging satellites' attitude controller and vibration isolator[J]. Aerospace Science and Technology, 2023, 133: 108100.
[3]Yu J, Nerse C, Chang K, et al. A framework of flexible locally resonant metamaterials for attachment to curved structures[J]. International Journal of Mechanical Sciences, 2021, 204: 106533.
[4]程明,黄静,孙俊.空间柔性结构振动控制智能作动技术研究进展[J].宇航学报,2025,46(01):37-50.
[5]曹尹琦,宁飞,杜言鲁,等.机载光电系统外置被动隔振平台设计与分析[J].应用光学,2024,45(06):1125-1131.
[6]刘海超,闫明,金映丽,等.仿生肢状准零刚度隔振系统的振动特性研究[J].振动工程学报,2025,38(01):29-38.
[7]吴思远,廖旭钊,荣坤杰,等.3种构造形式调谐质量阻尼器性能[J].同济大学学报(自然科学版),2024,52(09):1401-1408.
[8]Ding H, Chen L Q. Designs, analysis, and applications of nonlinear energy sinks[J]. Nonlinear Dynamics, 2020, 100(4): 3061-3107.
[9]Carrella A, Brennan M J, Waters T P. Static analysis of a passive vibration isolator with quasi-zero-stiffness characteristic[J]. Journal of sound and vibration, 2007, 301(3-5): 678-689.
[10]Chen T, Zheng Y, Song L, et al. Study on a quasi-zero-stiffness isolator for variable mass load[J]. Applied Mathematical Modelling, 2023, 123: 447-463.
[11]Lan C, Yang S, Wu Y. Design and experiment of a compact quasi-zero-stiffness isolator capable of a wide range of loads[J]. Journal of Sound and Vibration, 2014, 333(20): 4843-4858.
[12]徐鉴.振动控制研究进展综述[J].力学季刊,2015,36(04):547-565.
[13]Sun K, Tang J, Yang Y, et al. Active control of quasi-zero-stiffness vibration isolator with variable load[J]. International Journal of Structural Stability and Dynamics, 2024, 24(21): 2450243.
[14]Kalman R E. Contributions to the theory of optimal control[J]. Bol. soc. mat. mexicana, 1960, 5(2): 102-119.
[15]Bardi M, Dolcetta I C. Optimal control and viscosity solutions of Hamilton-Jacobi-Bellman equations[M]. Boston: Birkhäuser, 1997.
[16]Silver D, Schrittwieser J, Simonyan K, et al. Mastering the game of go without human knowledge[J]. nature, 2017, 550(7676): 354-359.
[17]Guo D, Yang D, Zhang H, et al. Deepseek-r1: Incentivizing reasoning capability in llms via reinforcement learning[J]. arXiv preprint arXiv:2501.12948, 2025.
[18]Alabuzhev P M. Vibration protection and measuring systems with quasi-zero stiffness[M]. CRC Press, 1989.
[19]Kovacic I, Brennan M J, Waters T P. A study of a nonlinear vibration isolator with a quasi-zero stiffness characteristic[J]. Journal of sound and vibration, 2008, 315(3): 700-711.
[20]Kovacic I, Brennan M J, Lineton B. Effect of a static force on the dynamic behaviour of a harmonically excited quasi-zero stiffness system[J]. Journal of Sound and Vibration, 2009, 325(4-5): 870-883.
[21]Liu X, Huang X, Hua H. On the characteristics of a quasi-zero stiffness isolator using Euler buckled beam as negative stiffness corrector[J]. Journal of Sound and Vibration, 2013, 332(14): 3359-3376.
[22]Bian J, Jing X. Analysis and design of a novel and compact X-structured vibration isolation mount (X-Mount) with wider quasi-zero-stiffness range[J]. Nonlinear Dynamics, 2020, 101(4): 2195-2222.
[23]Zhou X, Sun X, Zhao D, et al. The design and analysis of a novel passive quasi-zero stiffness vibration isolator[J]. Journal of Vibration Engineering & Technologies, 2021, 9: 225-245.
[24]李翊歆,唐介,刘冀钊,等.一种基于电磁—空气弹簧的非线性隔振器理论与实验研究[J].动力学与控制学报,2023,21(11):27-34.
[25]韩河生.基于折纸原理的准零刚度与超材料隔振设计及其动力学研究[D].哈尔滨工业大学,2022.
[26]Liu S, Peng G, Li Z, et al. Low-frequency vibration isolation via an elastic origami-inspired structure[J]. International Journal of Mechanical Sciences, 2023, 260: 108622.
[27]Ye K, Ji J. An origami inspired quasi-zero stiffness vibration isolator using a novel truss-spring based stack Miura-ori structure[J]. Mechanical Systems and Signal Processing, 2022, 165: 108383.
[28]Wang Q, Zhou J, Wang K, et al. Design and experimental study of a two-stage nonlinear vibration isolators with quasi-zero stiffness[J]. Communications in Nonlinear Science and Numerical Simulation, 2023, 122: 107246.
[29]Wang Y, Li S, Neild S A, et al. Comparison of the dynamic performance of nonlinear one and two degree-of-freedom vibration isolators with quasi-zero stiffness[J]. Nonlinear Dynamics, 2017, 88: 635-654.
[30]Zhou J, Zhou J, Pan H, et al. Multi-layer quasi-zero-stiffness meta-structure for high-efficiency vibration isolation at low frequency[J]. Applied Mathematics and Mechanics, 2024, 45(7): 1189-1208.
[31]Deng T, Wen G, Ding H, et al. A bio-inspired isolator based on characteristics of quasi-zero stiffness and bird multi-layer neck[J]. Mechanical Systems and Signal Processing, 2020, 145: 106967.
[32]Sun X, Qi Z, Xu J. A novel multi-layer isolation structure for transverse stabilization inspired by neck structure[J]. Acta Mechanica Sinica, 2022, 38(6): 521543.
[33]Chen T, Zheng Y, Song L, et al. Study on a quasi-zero-stiffness isolator for variable mass load[J]. Applied Mathematical Modelling, 2023, 123: 447-463.
[34]Wen G, He J, Liu J, et al. Design, analysis and semi-active control of a quasi-zero stiffness vibration isolation system with six oblique springs[J]. Nonlinear Dynamics, 2021, 106: 309-321.
[35]Sun K, Tang J, Yang Y, et al. Active control of quasi-zero-stiffness vibration isolator with variable load[J]. International Journal of Structural Stability and Dynamics, 2024, 24(21): 2450243.
[36]刘金琨,沈晓蓉,赵龙.系统辨识理论及MATLAB仿真[M].电子工业出版社,2013.
[37]Larimore W E. Canonical variate analysis in identification, filtering, and adaptive control[C]//29th IEEE Conference on Decision and control. IEEE, 1990: 596-604.
[38]Verhaegen M. Identification of the deterministic part of MIMO state space models given in innovations form from input-output data[J]. Automatica, 1994, 30(1): 61-74.
[39]Van Overschee P, De Moor B. N4SID: Subspace algorithms for the identification of combined deterministic-stochastic systems[J]. Automatica, 1994, 30(1): 75-93.
[40]Qu H, Li T, Chen G. Multiple analytical mode decompositions for nonlinear system identification from forced vibration[J]. Engineering Structures, 2018, 173: 979-986.
[41]Wei S, Peng Z K, Dong X J, et al. A nonlinear subspace-prediction error method for identification of nonlinear vibrating structures[J]. Nonlinear Dynamics, 2018, 91: 1605-1617.
[42]Holland J H. Genetic algorithms and the optimal allocation of trials[J]. SIAM journal on computing, 1973, 2(2): 88-105.
[43]Kennedy, J,Eberhart, R. Particle swarm optimization[C]//1995 IEEE International Conference on Neural Networks (ICNN 95).1995:1942-1948.
[44]Storn R, Price K. Differential evolution–a simple and efficient heuristic for global optimization over continuous spaces[J]. Journal of global optimization, 1997, 11: 341-359.
[45]Kristinsson K, Dumont G A. System identification and control using genetic algorithms[J]. IEEE Transactions on Systems, Man, and Cybernetics, 1992, 22(5): 1033-1046.
[46]Modares H, Alfi A, Fateh M M. Parameter identification of chaotic dynamic systems through an improved particle swarm optimization[J]. Expert Systems with Applications, 2010, 37(5): 3714-3720.
[47]Tang H, Xue S, Fan C. Differential evolution strategy for structural system identification[J]. Computers & Structures, 2008, 86(21-22): 2004-2012.
[48]Cybenko G. Approximation by superpositions of a sigmoidal function[J]. Mathematics of control, signals and systems, 1989, 2(4): 303-314.
[49]Hornik K, Stinchcombe M, White H. Multilayer feedforward networks are universal approximators[J]. Neural networks, 1989, 2(5): 359-366.
[50]邱锡鹏.神经网络与深度学习 [M].机械工业出版社,2020.
[51]Haykin S. Neural networks and learning machines, 3/E[M]. Pearson Education India, 2009.
[52]Hochreiter S, Schmidhuber J. Long short-term memory[J]. Neural computation, 1997, 9(8): 1735-1780.
[53]Chung J, Gulcehre C, Cho K H, et al. Empirical evaluation of gated recurrent neural networks on sequence modeling[J]. arXiv preprint arXiv:1412.3555, 2014.
[54]Chen R T Q, Rubanova Y, Bettencourt J, et al. Neural ordinary differential equations[J]. Advances in neural information processing systems, 2018, 31.
[55]Habiba M, Pearlmutter B A. Neural ordinary differential equation based recurrent neural network model[C]//2020 31st Irish signals and systems conference (ISSC). IEEE, 2020: 1-6.
[56]Zhang L, Sun Y, Wang A, et al. Neural network modeling and dynamic behavior prediction of nonlinear dynamic systems[J]. Nonlinear Dynamics, 2023, 111(12): 11335-11356.
[57]Lai Z, Mylonas C, Nagarajaiah S, et al. Structural identification with physics-informed neural ordinary differential equations[J]. Journal of Sound and Vibration, 2021, 508: 116196.
[58]Zhai W, Tao D, Bao Y. Parameter estimation and modeling of nonlinear dynamical systems based on runge–kutta physics-informed neural network[J]. Nonlinear Dynamics, 2023, 111(22): 21117-21130.
[59]Juang J G, Huang M T, Liu W K. PID control using presearched genetic algorithms for a MIMO system[J]. IEEE Transactions on Systems, Man, and Cybernetics, Part C (Applications and Reviews), 2008, 38(5): 716-727.
[60]Feng H, Ma W, Yin C, et al. Trajectory control of electro-hydraulic position servo system using improved PSO-PID controller[J]. Automation in Construction, 2021, 127: 103722.
[61]Zhou X, Li D, Zhang L, et al. Application of an adaptive PID controller enhanced by a differential evolution algorithm for precise control of dissolved oxygen in recirculating aquaculture systems[J]. Biosystems Engineering, 2021, 208: 186-198.
[62]Guo B, Liu H, Luo Z, et al. Adaptive PID controller based on BP neural network[C]//2009 International Joint Conference on Artificial Intelligence. IEEE, 2009: 148-150.
[63]Silver D, Lever G, Heess N, et al. Deterministic policy gradient algorithms[C]//International conference on machine learning. Pmlr, 2014: 387-395.
[64]Lillicrap T P, Hunt J J, Pritzel A, et al. Continuous control with deep reinforcement learning[J]. arXiv preprint arXiv:1509.02971, 2015.
[65]Zhang Y, Zhu S. Novel model‐free optimal active vibration control strategy based on deep reinforcement learning[J]. Structural control and health monitoring, 2023, 2023(1): 6770137.
[66]Qiu Z, Yang Y, Zhang X. Heterogeneous reinforcement learning vibration control of coupling system with four flexible beams connected by springs[J]. Mechatronics, 2023, 95: 103063.
[67]Garcia C E, Prett D M, Morari M. Model predictive control: Theory and practice—A survey[J]. Automatica, 1989, 25(3): 335-348.
[68]Soloway D, Haley P J. Neural generalized predictive control[C]//Proceedings of the 1996 IEEE international symposium on intelligent control. IEEE, 1998: 277-282.
[69]Peng H, Li F, Kan Z. A novel distributed model predictive control method based on a substructuring technique for smart tensegrity structure vibrations[J]. Journal of Sound and Vibration, 2020, 471: 115171.

攻读硕士学位期间取得的研究成果
攻读硕士学位期间共参与发表论文5篇，其中以第一作者身份发表论文3篇。参研1项国家自然科学，1项四川省自然科学基金。参与学术会议1次。

一、攻读硕士学位期间发表的论文
[1]	Jiang JY, Tang J*, Sun K, Chen HT, Li YH, Cao DQ. Data-driven model identification and control of the quasi-zero-stiffness system[J]. Nonlinear Dynamics, 2024: 1-15. [SCI, IF=5.2, 中科院2区]
[2]	Jiang JY, Tang J*, Zhao K, Li M, Li YH, Cao DQ. Model-Free Optimal Vibration Control of a Nonlinear System Based on Deep Reinforcement Learning[J]. International Journal of Structural Stability and Dynamics, 2024: 2550079. [SCI, IF=3.0, 中科院3区]
[3]	Jiang JY, Tang J*, Liu M, Li M, Li YH, Chen HT, Cao DQ. A Data-Driven Neural Network Model Predictive Controller for Multi-layer Nonlinear Vibration Isolation System[J]. Aerospace Science and Technology. [SCI, IF=5.0, 中科院1区top, Under Review]
[4]	唐介*, 蒋纪元, 赵坤, 李映辉. 数据驱动的结构振动鲁棒控制策略研究[J]. 振动与冲击, 2024, 43(19): 194-201. [EI]
[5]	Huang YW, Tang J*, Jiang JY, Li YH, Liu M, Chen HT, Cao DQ. Physics-informed neural networks identification and reinforcement learning control for a nonlinear vibration system[J]. Journal of Vibration Engineering & Technologies. [SCI, IF=2.1, 中科院4区, Under Review]

二、参与的科研项目
[1]	国家自然科学基金青年科学基金项目，气动环境下轴向运动细长结构的非线性隔振研究，12102368，参研。
[2]	四川省自然科学基金青年科学基金项目，气动环境下高速列车的非线性减振机理研究，2022NSFSC1961，参研。

三、参加的学术会议
[1]	蒋纪元, 唐介, 李映辉, 曹登庆. 非线性振动系统的深度强化学习控制策略研究[R], 第十五届全国振动理论及应用学术会议, 2023年10月, 成都.